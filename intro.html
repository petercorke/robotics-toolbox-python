

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Introduction &mdash; Robotics Toolbox for Python  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"TeX": {"Macros": {"presup": ["\\,{}^{\\scriptscriptstyle #1}\\!", 1], "SE": ["\\mathbf{SE}(#1)", 1], "SO": ["\\mathbf{SO}(#1)", 1], "se": ["\\mathbf{se}(#1)", 1], "so": ["\\mathbf{so}(#1)", 1], "vec": ["\\boldsymbol{#1}", 1], "dvec": ["\\dot{\\boldsymbol{#1}}", 1], "ddvec": ["\\ddot{\\boldsymbol{#1}}", 1], "fvec": ["\\presup{#1}\\boldsymbol{#2}", 2], "fdvec": ["\\presup{#1}\\dot{\\boldsymbol{#2}}", 2], "fddvec": ["\\presup{#1}\\ddot{\\boldsymbol{#2}}", 2], "norm": ["\\Vert #1 \\Vert", 1], "mat": ["\\mathbf{#1}", 1], "fmat": ["\\presup{#1}\\mathbf{#2}", 2], "sk": ["\\left[#1\\right]", 1], "skx": ["\\left[#1\\right]_{\\times}", 1], "vex": ["\\vee\\left( #1\\right)", 1], "vexx": ["\\vee_{\\times}\\left( #1\\right)", 1], "q": "\\mathring{q}", "fq": ["\\presup{#1}\\mathring{q}", 1]}}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Manipulator arms" href="arm.html" />
    <link rel="prev" title="Robotics Toolbox for Python" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> Robotics Toolbox for Python
          

          
            
            <img src="_static/RobToolBox_RoundLogoB.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id1">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#a-python-version">A Python version</a></li>
<li class="toctree-l2"><a class="reference internal" href="#spatial-math-layer">Spatial math layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="#robotics-toolbox">Robotics Toolbox</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#robot-models">Robot models</a></li>
<li class="toctree-l3"><a class="reference internal" href="#denavit-hartenberg-parameters">Denavit-Hartenberg parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ets-notation">ETS notation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#erobot-rigid-body-tree-and-urdf-import">ERobot: rigid-body tree and URDF import</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#trajectories">Trajectories</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#symbolic-manipulation">Symbolic manipulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#differential-kinematics">Differential kinematics</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dynamics">Dynamics</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#new-capability">New capability</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#branched-mechanisms">Branched mechanisms</a></li>
<li class="toctree-l3"><a class="reference internal" href="#collision-checking">Collision checking</a></li>
<li class="toctree-l3"><a class="reference internal" href="#interfaces">Interfaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="#code-engineering">Code engineering</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#conclusion">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="arm.html">Manipulator arms</a></li>
<li class="toctree-l1"><a class="reference internal" href="mobile.html">Mobile robots</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Robotics Toolbox for Python</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Introduction</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/intro.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="arm.html" class="btn btn-neutral float-right" title="Manipulator arms" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Robotics Toolbox for Python" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">Â¶</a></h1>
<div class="section" id="id1">
<h2>Introduction<a class="headerlink" href="#id1" title="Permalink to this headline">Â¶</a></h2>
<p>The Robotics Toolbox for MATLABÂ® (RTB-M) was created around 1991 to support the
first authorâ€™s PhD research and was first published in 1995-6 <a class="reference internal" href="#corke95d" id="id2"><span>[Corke95d]</span></a>
<a class="reference internal" href="#corke96j" id="id3"><span>[Corke96j]</span></a>. It has evolved over 25 years to track changes and improvements to
the MATLAB language and ecosystem, such as the addition of structures, objects,
lists (cell arrays) and strings, myriad of other improvements to the language,
new graphics and new tools such as IDE, debugger, notebooks (LiveScripts), apps
and continuous integration.  An adverse consequence is that many poor (in
retrospect) early design decisions hinder development.</p>
<p>Over time additional functionality was added, in particular for vision, and two
major refactorings led to the current state of three toolboxes: Robotics Toolbox
for MATLAB and Machine Vision Toolbox for MATLAB (1999) both of which are built
on the Spatial Math Toolbox for MATLAB (SMTB-M) in 2019.</p>
<p>The code was formally open sourced to support its use for the third edition of John Craigâ€™s book <a class="reference internal" href="#craig2005" id="id4"><span>[Craig2005]</span></a>.
It was hosted on ftp sites, personal web servers, Google code and currently GitHub and maintained under a succession of version control tools including rcs, cvs, svn and git.  A support forum on Google Groups was established in 2008 and currently has over 1400 members.</p>
</div>
<div class="section" id="a-python-version">
<h2>A Python version<a class="headerlink" href="#a-python-version" title="Permalink to this headline">Â¶</a></h2>
<p>The imperative for a Python version has long existed and the first port was
started in 2008 but ultimately failed for lack of ongoing resources to complete
a sufficient subset of functionality. Subsequent attempts have all met the same
fate.</p>
<p>The design goals of this version can be summarised as new functionality:</p>
<ul class="simple">
<li><p>A superset of the MATLAB Toolbox functionality</p></li>
<li><p>Build on the Spatial Math Toolbox for Python which provides objects to
represent rotations as matrices SO(2) and SE(3) as well as unit-quaternions,
rigid-body motions as SE(2) and SE(3) matrices as well as twists in
se(2) and se(3), and Featherstoneâ€™s spatial vectors <a class="reference internal" href="#featherstone87" id="id5"><span>[Featherstone87]</span></a>.</p></li>
<li><p>Support models expressed using Denavit-Hartenberg notation (standard and
modified), elementary transform sequences <a class="reference internal" href="#ets1" id="id6"><span>[ets1]</span></a> <a class="reference internal" href="#ets2" id="id7"><span>[ets2]</span></a>, and URDF-style
rigid-body trees.  Support branched, but not closed-loop or parallel, robots</p></li>
<li><p>Collision checking</p></li>
</ul>
<p>and improved software engineering:</p>
<ul class="simple">
<li><p>Use Python 3 (3.6 and greater)</p></li>
<li><p>Utilize WebGL and Javascript graphics technologies</p></li>
<li><p>Documentation in ReStructured Text using Sphinx and delivered via GitHub pages.</p></li>
<li><p>Hosted on GitHub with continuous integration using GitHub actions</p></li>
<li><p>High code-quality metrics for test coverage and automated code review and security analysis</p></li>
<li><p>As few dependencies as possible, in particular being able to work with ROS but not be dependent on ROS. This sidesteps ROS constraints on operating system and Python versions.</p></li>
<li><p>Modular approach to interfacing to different graphics libraries, simulators and physical robots.</p></li>
<li><p>Support Python notebooks which allows publication of static notebooks (for example via GitHub) and interactive online notebooks (<a class="reference external" href="MyBinder.org">MyBinder.org</a>).</p></li>
<li><p>Use of UniCode characters to make console output easier to read</p></li>
</ul>
</div>
<div class="section" id="spatial-math-layer">
<h2>Spatial math layer<a class="headerlink" href="#spatial-math-layer" title="Permalink to this headline">Â¶</a></h2>
<p>Robotics and computer vision require us to describe position, orientation and
pose in 3D space. Mobile robotics has the same requirement, but generally for 2D
space. We therefore need tools to represent quantities such as rigid-body
transformations (matrices <span class="math notranslate nohighlight">\(\in \SE{n}\)</span> or twists <span class="math notranslate nohighlight">\(\in \SE{n}\)</span>),
rotations (matrices <span class="math notranslate nohighlight">\(\in \SO{n}\)</span> or <span class="math notranslate nohighlight">\(\so{n}\)</span>, Euler or roll-pitch-yaw
angles, or unit quaternions <span class="math notranslate nohighlight">\(\in \mathrm{S}^3\)</span>). Such capability is amongst the oldest in
RTB-M and the equivalent functionality exists in RTB-P which makes use of the
<a class="reference external" href="https://github.com/petercorke/spatialmath-python">Spatial Maths Toolbox for Python (SMTB-P)</a>. For example:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">spatialmath.base</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">transl</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">@</span> <span class="n">rpy2tr</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;xyz&#39;</span><span class="p">)</span> <span class="o">@</span> <span class="n">trotx</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="s1">&#39;deg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="go">[[ 0.9752 -0.1987 -0.0978  0.5   ]</span>
<span class="go"> [ 0.1538  0.2896  0.9447  0.    ]</span>
<span class="go"> [-0.1593 -0.9363  0.313   0.    ]</span>
<span class="go"> [ 0.      0.      0.      1.    ]]</span>
</pre></div>
</div>
<p>There is strong similarity to the equivalent MATLAB case apart from the use of
the <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> operator, the use of keyword arguments instead of keyword-value pairs,
and the format of the printed array. All the <em>classic</em> RTB-M functions are
provided in the <code class="docutils literal notranslate"><span class="pre">spatialmath.base</span></code> package as well as additional functions for
quaternions, vectors, twists and argument handling.  There are also functions to
perform interpolation, plot and animate coordinate frames, and create movies,
using matplotlib. The underlying datatypes in all cases are 1D and 2D NumPy
arrays.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>For a user transitioning from MATLAB the most significant difference is
the use of 1D arrays â€“ all MATLAB arrays have two dimensions, even if one of
them is equal to one.</p>
</div>
<p>However some challenges arise when using arrays, whether native MATLAB matrices
or NumPy arrays as in this case. Firstly, arrays are not typed and for example a
<span class="math notranslate nohighlight">\(3 \times 3\)</span> array could be an element of <span class="math notranslate nohighlight">\(\SE{2}\)</span> or
<span class="math notranslate nohighlight">\(\SO{3}\)</span> or an arbitrary matrix.</p>
<p>Secondly, the operators we need for poses are a subset of those available for
matrices, and some operators may need to be redefined in a specific way. For
example, <span class="math notranslate nohighlight">\(\SE{3} * \SE{3} \rightarrow \SE{3}\)</span> but <span class="math notranslate nohighlight">\(\SE{3} + \SE{3} \rightarrow \mathbb{R}^{4 \times 4}\)</span>, and equality testing for a
unit-quaternion has to respect the double mapping.</p>
<p>Thirdly, in robotics we often need to represent time sequences of poses.  We
could add an extra dimension to the matrices representing rigid-body
transformations or unit-quaternions, or place them in a list.  The first
approach is cumbersome and reduces code clarity, while the second cannot ensure
that all elements of the list have the same type.</p>
<p>We  use classes and data encapsulation to address all these issues. SMTB-P
provides abstraction classes <code class="docutils literal notranslate"><span class="pre">SE3</span></code>, <code class="docutils literal notranslate"><span class="pre">Twist3</span></code>, <code class="docutils literal notranslate"><span class="pre">SO3</span></code>, <code class="docutils literal notranslate"><span class="pre">UnitQuaternion</span></code>,
<code class="docutils literal notranslate"><span class="pre">SE2</span></code>, <code class="docutils literal notranslate"><span class="pre">Twist2</span></code> and <code class="docutils literal notranslate"><span class="pre">SO2</span></code>. For example, the previous example could be written
as</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">spatialmath</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">SE3</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">SE3</span><span class="o">.</span><span class="n">RPY</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;xyz&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="n">SE3</span><span class="o">.</span><span class="n">Rx</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="go">  [38;5;1m 0.97517    [0m[38;5;1m-0.198669   [0m[38;5;1m-0.0978434  [0m[38;5;4m 0.5        [0m  [0m</span>
<span class="go">  [38;5;1m 0.153792   [0m[38;5;1m 0.289629   [0m[38;5;1m 0.944702   [0m[38;5;4m 0          [0m  [0m</span>
<span class="go">  [38;5;1m-0.159345   [0m[38;5;1m-0.936293   [0m[38;5;1m 0.312992   [0m[38;5;4m 0          [0m  [0m</span>
<span class="go">  [38;5;244m 0          [0m[38;5;244m 0          [0m[38;5;244m 0          [0m[38;5;244m 1          [0m  [0m</span>

</pre></div>
</div>
<p>where composition is denoted by the * operator and the matrix is printed more elegantly (and elements are color
coded at the console or in ipython).
<code class="docutils literal notranslate"><span class="pre">SE3.RPY()</span></code> is a class method that acts like a constructor, creating an <code class="docutils literal notranslate"><span class="pre">SE3</span></code> instance from a set of roll-pitch-yaw angles,
and <code class="docutils literal notranslate"><span class="pre">SE3.Rx()</span></code> creates an <code class="docutils literal notranslate"><span class="pre">SE3</span></code> instance from a pure rotation about the x-axis.
Attempts to compose with a non <code class="docutils literal notranslate"><span class="pre">SE3</span></code> instance would result in a <code class="docutils literal notranslate"><span class="pre">TypeError</span></code>.</p>
<p>The orientation of the new coordinate frame may be expressed in terms of Euler angles
the rotation matrix can be easily extractedand</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">spatialmath</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">SE3</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">SE3</span><span class="o">.</span><span class="n">RPY</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;xyz&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="n">SE3</span><span class="o">.</span><span class="n">Rx</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span><span class="o">.</span><span class="n">eul</span><span class="p">()</span>
<span class="go">array([ 95.9131,  71.7604, -80.3415])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span><span class="o">.</span><span class="n">R</span>
<span class="go">array([[ 0.9752, -0.1987, -0.0978],</span>
<span class="go">       [ 0.1538,  0.2896,  0.9447],</span>
<span class="go">       [-0.1593, -0.9363,  0.313 ]])</span>
</pre></div>
</div>
<p>and we can plot the coordinate frame:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">T</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;2&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Similar constructors allow object construction with orientation expressed in terms of an angle-vector pair or orientation
and approach vectors.</p>
<p>Rotation can also be represented by a unit quaternion</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">spatialmath</span> <span class="kn">import</span> <span class="n">UnitQuaternion</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">UnitQuaternion</span><span class="o">.</span><span class="n">Rx</span><span class="p">(</span><span class="mf">0.3</span><span class="p">))</span>
<span class="go">0.988771 &lt;&lt; 0.149438, 0.000000, 0.000000 &gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">UnitQuaternion</span><span class="o">.</span><span class="n">AngVec</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>
<span class="go">0.988771 &lt;&lt; 0.149438, 0.000000, 0.000000 &gt;&gt;</span>
</pre></div>
</div>
<p>which again demonstrates several alternative constructors.
The classes are somewhat polymorphic and have the same constructors for canonic rotations, Euler and roll-pitch-yaw angles, angle-vector,
as well as a random value.  <span class="math notranslate nohighlight">\(\SE{n}\)</span> and <span class="math notranslate nohighlight">\(\SO{n}\)</span> also support a matrix exponential constructor where the argument is the
corresponding Lie algebra element.</p>
<p>To support trajectories each of these types inherits list properties from <code class="docutils literal notranslate"><span class="pre">collections.UserList</span></code></p>
<div class="figure align-default" id="id24">
<a class="reference internal image-reference" href="../figs/pose-values.png"><img alt="Any of the SMTB-P pose classes can contain a list of values" src="../figs/pose-values.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-text">Any of the SMTB-P pose classes can contain a list of values</span><a class="headerlink" href="#id24" title="Permalink to this image">Â¶</a></p>
</div>
<p>We can index the values, iterate over the values, assign to values.
Some constructors take an array-like argument allowing creation of multi-valued pose objects,
for example</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>where the instance <code class="docutils literal notranslate"><span class="pre">R</span></code> contains a sequence of 100 rotation matrices.
Composition with a single-valued (scalar) pose instance  broadcasts the scalar
across the sequence</p>
<div class="figure align-default" id="id25">
<img alt="Overloaded operators support broadcasting" src="../figs/broadcasting.png" />
<p class="caption"><span class="caption-text">Overloaded operators support broadcasting</span><a class="headerlink" href="#id25" title="Permalink to this image">Â¶</a></p>
</div>
<p>The types all have an inverse method <code class="docutils literal notranslate"><span class="pre">.inv()</span></code> and support composition with the inverse using the <code class="docutils literal notranslate"><span class="pre">/</span></code> operator
and integer exponentiation (repeated composition) using the <code class="docutils literal notranslate"><span class="pre">**</span></code> operator.
Other overloaded operators include <em>, *=, *</em>, <a href="#id8"><span class="problematic" id="id9">**</span></a>=, /, /=, ==, !=, +, -.
Supporting classes include <code class="docutils literal notranslate"><span class="pre">Quaternion</span></code> and <code class="docutils literal notranslate"><span class="pre">Plucker</span></code>.</p>
<p>All of this allows for concise and readable code.
The use of classes ensures type safety and that the matrices abstracted by the class are always valid members of
the group.
Operations such as addition which are not group operations yield a NumPy array rather than a class instance.</p>
<p>These benefits come at a price in terms of execution time due to the overhead of constructors and methods which wrap base functions, and type checking.
The Toolbox supports SymPy which provides powerful symbolic support for Python and it works well in conjunction with NumPy, ie. a NumPy array can contain symbolic elements.  Many the Toolbox methods and functions contain extra logic to ensure that symbolic operations work as expected. While this adds to the overhead it means that for the user, working with symbols is as easy as working with numbers.</p>
<table class="docutils align-default" id="id26">
<caption><span class="caption-text">Performance on a 3.6GHz Intel Core i9</span><a class="headerlink" href="#id26" title="Permalink to this table">Â¶</a></caption>
<colgroup>
<col style="width: 58%" />
<col style="width: 42%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Function/method</p></th>
<th class="head"><p>Execution time</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">base.rotx()</span></code></p></td>
<td><p>4.07 Î¼s</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">base.trotx()</span></code></p></td>
<td><p>5.79 Î¼s</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">SE3.Rx()</span></code></p></td>
<td><p>12.3 Î¼s</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">SE3</span> <span class="pre">*</span> <span class="pre">SE3</span></code></p></td>
<td><p>4.69 Î¼s</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">4x4</span> <span class="pre">&#64;</span></code></p></td>
<td><p>0.986 Î¼s</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">SE3.inv()</span></code></p></td>
<td><p>7.62 Î¼s</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">base.trinv()</span></code></p></td>
<td><p>4.19 Î¼s</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">np.linalg.inv()</span></code></p></td>
<td><p>4.49 Î¼s</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="robotics-toolbox">
<h2>Robotics Toolbox<a class="headerlink" href="#robotics-toolbox" title="Permalink to this headline">Â¶</a></h2>
<div class="section" id="robot-models">
<h3>Robot models<a class="headerlink" href="#robot-models" title="Permalink to this headline">Â¶</a></h3>
<p>The Toolbox ships with over 30 robot models, most are purely kinematic but some have inertial and frictional parameters.
Kinematic models can be specified in a variety of ways:  standard or modified Denavit-Hartenberg (DH, MDH) notation, as an ETS string <a class="reference internal" href="#ets1" id="id10"><span>[ets1]</span></a>,
as a rigid-body tree, or from a URDF file.</p>
</div>
<div class="section" id="denavit-hartenberg-parameters">
<h3>Denavit-Hartenberg parameters<a class="headerlink" href="#denavit-hartenberg-parameters" title="Permalink to this headline">Â¶</a></h3>
<p>To specify a kinematic model using DH notation, we create a new subclass of <code class="docutils literal notranslate"><span class="pre">DHRobot</span></code> and pass the superclass constructor
a list of link objects.  For example, an IRB140 is simply:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">robot</span> <span class="o">=</span> <span class="n">DHRobot</span><span class="p">(</span>
<span class="go">    [</span>
<span class="go">        RevoluteDH(d=d1, a=a1, alpha=-pi/2),</span>
<span class="go">        RevoluteDH(a=a2),</span>
<span class="go">        RevoluteDH(alpha=pi/2),</span>
<span class="go">        ...</span>
<span class="go">    ], name=&quot;my IRB140&quot;)</span>
</pre></div>
</div>
<p>where only the non-zero parameters need to be specified.
In this case we used <code class="docutils literal notranslate"><span class="pre">RevoluteDH</span></code> objects for a revolute joint described using standard DH conventions.  Other classes available
are <code class="docutils literal notranslate"><span class="pre">PrismaticDH</span></code>, <code class="docutils literal notranslate"><span class="pre">RevoluteMDH</span></code> and <code class="docutils literal notranslate"><span class="pre">PrismaticMDH</span></code>.
Other parameters such as mass,  CoG, link inertia, motor inertia, viscous friction, Coulomb friction, and joint limits can also be specified using additional keyword arguments.</p>
<p>We can now easily perform standard kinematic operations</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">roboticstoolbox</span> <span class="k">as</span> <span class="nn">rtb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">puma</span> <span class="o">=</span> <span class="n">rtb</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">DH</span><span class="o">.</span><span class="n">Puma560</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">puma</span><span class="o">.</span><span class="n">fkine</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="n">puma</span><span class="o">.</span><span class="n">ikine</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">ikine</span></code> is a generalised iterative numerical solution based on Levenberg-Marquadt minimization, and additional status results are also returned.
The default plot interface:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">puma</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
</pre></div>
</div>
<p>using matplotlib, produces a <a href="#id11"><span class="problematic" id="id12">``</span></a>noodle robotâ€™â€™ plot like</p>
<p>NOODLE PLOT HERE</p>
<p>The starting point for the solution may be specified, but
defaults to zero, and affects both the search time and the solution found, since in general
a manipulator may have several poses which result in the same end-effector pose.
For a redundant manipulator a solution will be found but there is no
explicit control over the null-space.  For a manipulator with <span class="math notranslate nohighlight">\(n &lt; 6\)</span> DOF
an additional argument is required to indicate which of the
<span class="math notranslate nohighlight">\(6-n\)</span> Cartesian DOF are to be unconstrained in the solution.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A solution is not possible if the specified transform describes
a point out of reach of the manipulator â€“ in such a case the function will
return with an error.</p>
</div>
<p>The inverse kinematic procedure for any specific robot can
be derived symbolically
and commonly an efficient closed-form solution can be obtained.
Some robot classes have an analytical solution coded, for example</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
<div class="section" id="ets-notation">
<h3>ETS notation<a class="headerlink" href="#ets-notation" title="Permalink to this headline">Â¶</a></h3>
<p>A Puma robot can also be specified in ETS format <a class="reference internal" href="#ets1" id="id13"><span>[ets1]</span></a> as a sequence of simple rigid-body transformations, pure translation
or pure rotation, with a constant parameter or a free parameter which is a joint variable</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;input&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
<span class="gr">NameError</span>: <span class="n">name &#39;e&#39; is not defined</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;input&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
<span class="gr">NameError</span>: <span class="n">name &#39;robot&#39; is not defined</span>
</pre></div>
</div>
<p>and can represent single-branched robots with any combination of revolute and prismatic joints.</p>
</div>
<div class="section" id="erobot-rigid-body-tree-and-urdf-import">
<h3>ERobot: rigid-body tree and URDF import<a class="headerlink" href="#erobot-rigid-body-tree-and-urdf-import" title="Permalink to this headline">Â¶</a></h3>
<p>The final approach is to an import a URDF file.  The Toolbox includes a parser with built-in xacro processor
which makes many models from the ROS universe available.</p>
<p>More complex models such as for Panda or Puma are defined by classes but built this way</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">roboticstoolbox</span> <span class="k">as</span> <span class="nn">rtb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">panda</span> <span class="o">=</span> <span class="n">rtb</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">URDF</span><span class="o">.</span><span class="n">Panda</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">panda</span><span class="o">.</span><span class="n">fkine</span><span class="p">(</span><span class="n">panda</span><span class="o">.</span><span class="n">qz</span><span class="p">)</span>
</pre></div>
</div>
<p>and forward kinematics is simplyâ€¦</p>
<p>where known poses are defined by properties such <code class="docutils literal notranslate"><span class="pre">panda.qz</span></code>.
For branched robots, with multipe end-effectors,  the name of the frame of interest must be provided.</p>
<p>This pose can be visualized by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">panda</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">qz</span><span class="p">)</span>
</pre></div>
</div>
<p>which produces the 3-D plot shown in Figure ref{fig:noodle}.</p>
<p>and inverse kinematic is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">panda</span><span class="o">.</span><span class="n">ikine</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="trajectories">
<h2>Trajectories<a class="headerlink" href="#trajectories" title="Permalink to this headline">Â¶</a></h2>
<p>A joint-spae trajectory for the Puma robot from its zero angle
pose to the upright (or READY) pose in 100 steps is</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">puma.qr</span></code> is an example of a named joint configuration.
<code class="docutils literal notranslate"><span class="pre">traj</span></code> is named tuple with elements <code class="docutils literal notranslate"><span class="pre">q</span></code> = <span class="math notranslate nohighlight">\(\vec{q}_k\)</span>, <code class="docutils literal notranslate"><span class="pre">qd</span></code> = <span class="math notranslate nohighlight">\(\dvec{q}_k\)</span> and <code class="docutils literal notranslate"><span class="pre">qdd</span></code> = <span class="math notranslate nohighlight">\(\ddvec{q}_k\)</span>.
Each element is an array with one row per time step, and each row a joint angle vector.
The trajectory is a fifth order polynomial which has continuous jerk.
By default, the initial and final velocities are zero, but these may be specified by additional
arguments.</p>
<p>Straight line (Cartesian) paths can be generated in a similar way between
two points specified by a pair of poses in <span class="math notranslate nohighlight">\(\SE{3}\)</span></p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/spatialmath/super_pose.py&quot;, line 368, in &lt;listcomp&gt;</span>
<span class="go">    return self.__class__([tr.trinterp(start, self.A, s=_s) for _s in s])</span>
<span class="go">  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/spatialmath/base/transforms3d.py&quot;, line 1131, in trinterp</span>
<span class="go">    assert 0 &lt;= s &lt;= 1, &#39;s outside interval [0,1]&#39;</span>
<span class="go">AssertionError: s outside interval [0,1]</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;input&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
<span class="gr">NameError</span>: <span class="n">name &#39;Ts&#39; is not defined</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;input&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
<span class="gr">NameError</span>: <span class="n">name &#39;Ts&#39; is not defined</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;input&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
<span class="gr">NameError</span>: <span class="n">name &#39;qs&#39; is not defined</span>
</pre></div>
</div>
<p>The resulting trajectory, <code class="docutils literal notranslate"><span class="pre">Ts</span></code>, is an <code class="docutils literal notranslate"><span class="pre">SE3</span></code> instance with 200 values.
For both trajectory types the number of steps is given by an integer argument or the length of a
passed time vector.</p>
<p>Inverse kinematics can then be applied to determine the corresponding
joint angle motion using the <code class="docutils literal notranslate"><span class="pre">ikine</span></code> method and <a href="#id14"><span class="problematic" id="id15">``</span></a>qs``is is an array of joint coordinates, one row per timestep.
In this case the starting
joint coordinates for each inverse kinematic solution
is taken as the result of the previous solution.</p>
<div class="section" id="symbolic-manipulation">
<h3>Symbolic manipulation<a class="headerlink" href="#symbolic-manipulation" title="Permalink to this headline">Â¶</a></h3>
<p>As mentioned earlier, the Toolbox supports SymPy. For example:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;input&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
<span class="gr">NameError</span>: <span class="n">name &#39;phi&#39; is not defined</span>
</pre></div>
</div>
<p>The capability extends to forward kinematics</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;input&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
<span class="gr">NameError</span>: <span class="n">name &#39;q&#39; is not defined</span>
</pre></div>
</div>
<div class="highlight-pycon notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="go">    ^</span>
<span class="go">IndentationError: unexpected indent</span>
  File <span class="nb">&quot;&lt;input&gt;&quot;</span>, line <span class="m">1</span>
    <span class="n">T</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="o">^</span>
<span class="gr">IndentationError</span>: <span class="n">unexpected indent</span>
</pre></div>
</td></tr></table></div>
<p>If we display the value of <code class="docutils literal notranslate"><span class="pre">puma</span></code> we see that the <span class="math notranslate nohighlight">\(\alpha_j\)</span> values are now displayed in red to indicate that they are symbolic constants.  The x-coordinate of the end-effector is
given by line 3.</p>
<p>SymPy allows any expression to be converted to runnable code in a variety of languages including C, Python and Octave/MATLAB.</p>
</div>
<div class="section" id="differential-kinematics">
<h3>Differential kinematics<a class="headerlink" href="#differential-kinematics" title="Permalink to this headline">Â¶</a></h3>
<p>The Toolbox computes Jacobians:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">J</span> <span class="o">=</span> <span class="n">puma</span><span class="o">.</span><span class="n">jacob0</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">J</span> <span class="o">=</span> <span class="n">puma</span><span class="o">.</span><span class="n">jacobe</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
</pre></div>
</div>
<p>in the base or end-effector frames respectively, as NumPy arrays.
At a singular configuration</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>Jacobians can also be computed for symbolic joint variables as for forward kinematics above.</p>
<p>For var{ERobot``instances we can also compute the Hessians:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">puma</span><span class="o">.</span><span class="n">hessian0</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">puma</span><span class="o">.</span><span class="n">hessiane</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
</pre></div>
</div>
<p>in the base or end-effector frames respectively, as 3D NumPy arrays in <span class="math notranslate nohighlight">\(\mathbb{R}^{6 \times n \times n}\)</span>.</p>
<p>For all robot classes we can compute manipulability</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>for the Yoshikawa and Asada measures respectively, and</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>is the Yoshikawa measure computed for just the task space translational degrees
of freedom.
For <code class="docutils literal notranslate"><span class="pre">ERobot</span></code> instances we can also compute the manipulability
Jacobian:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Jm</span> <span class="o">=</span> <span class="n">puma</span><span class="o">.</span><span class="n">manipm</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">H</span><span class="p">)</span>
</pre></div>
</div>
<p>such that <span class="math notranslate nohighlight">\(\dot{m} = \mat{J}_m(\vec{q}) \dvec{q}\)</span>.</p>
</div>
<div class="section" id="dynamics">
<h3>Dynamics<a class="headerlink" href="#dynamics" title="Permalink to this headline">Â¶</a></h3>
<p>The new Toolbox supports several approaches to computing dynamics.
For models defined using standard or modified DH notation we use a classical version of the recursive Newton-Euler
algorithm implemented in Python or C.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The same code as used by RTB-M is called directly from Python, and does not use NumPy.</p>
</div>
<p>For example, the inverse dynamics</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">roboticstoolbox</span> <span class="k">as</span> <span class="nn">rtb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">puma</span> <span class="o">=</span> <span class="n">rtb</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">DH</span><span class="o">.</span><span class="n">Puma560</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tau</span> <span class="o">=</span> <span class="n">puma</span><span class="o">.</span><span class="n">rne</span><span class="p">(</span><span class="n">puma</span><span class="o">.</span><span class="n">qn</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">6</span><span class="p">,)),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">6</span><span class="p">,)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">tau</span><span class="p">)</span>
<span class="go">[-0.     31.6399  6.0351  0.      0.0283  0.    ]</span>
</pre></div>
</div>
<p>is the gravity torque for the robot in the configuration <code class="docutils literal notranslate"><span class="pre">qn</span></code>.</p>
<p>Inertia, Coriolis/centripetal and gravity terms are computed by</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;input&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
<span class="gr">NameError</span>: <span class="n">name &#39;q&#39; is not defined</span>
</pre></div>
</div>
<p>respectively, using the method of Orin and Walker from the inverse dynamics.  These values include the effect of motor inertia and friction.</p>
<p>Forward dynamics are given by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">qdd</span> <span class="o">=</span> <span class="n">puma</span><span class="o">.</span><span class="n">accel</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">qd</span><span class="p">)</span>
</pre></div>
</div>
<p>which we can integrate over time:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">puma</span><span class="o">.</span><span class="n">fdyn</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">mycontrol</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>uses an RK45 numerical integration from the SciPy package to solve for the joint trajectory <code class="docutils literal notranslate"><span class="pre">q</span></code> given the
control function called as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tau</span> <span class="o">=</span> <span class="n">mycontrol</span><span class="p">(</span><span class="n">robot</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">qd</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
</pre></div>
</div>
<p>The fast C implementation is not capable of symbolic operation so a Python version of RNE <code class="docutils literal notranslate"><span class="pre">rne\_python</span></code> has been
implemented as well.  For a 6- or 7-DoF manipulator the torque expressions have thousands of terms yet are computed in less than a second. However, subsequent expression manipulation is slow, and the best strategy is to eliminate the least significant terms and this typically gets the expression for the first joint to a hundred or so terms which is quite manageable.
This is an area of active work, as is the automatic generation of efficient run-time
code for manipulator dynamics.</p>
<p>For the Puma560 robot the C version of inverse dynamics takes 23Î¼s while the
Python version takes 1.5ms (<span class="math notranslate nohighlight">\(65\times\)</span> slower).  With symbolic operands it takes 170ms``(<span class="math notranslate nohighlight">\(113\times\)</span> slower) to produce the unsimplified torque expressions.</p>
<p>For all robots there is also an implementation of Featherstoneâ€™s spatial vector method, <code class="docutils literal notranslate"><span class="pre">rne_spatial()</span></code>, and SMTB-P provides a set of classes for
spatial velocity, acceleration, momentum, force and inertia.</p>
</div>
</div>
<div class="section" id="new-capability">
<h2>New capability<a class="headerlink" href="#new-capability" title="Permalink to this headline">Â¶</a></h2>
<p>There are several areas of innovation compared to the MATLAB version of the Toolbox.</p>
<div class="section" id="branched-mechanisms">
<h3>Branched mechanisms<a class="headerlink" href="#branched-mechanisms" title="Permalink to this headline">Â¶</a></h3>
<p>The RTB-M <code class="docutils literal notranslate"><span class="pre">SerialLink</span></code> class had no option to express branching.
In RTB-P the equivalent class is <code class="docutils literal notranslate"><span class="pre">DHRobot``is</span> <span class="pre">similarly</span> <span class="pre">limited,</span> <span class="pre">but</span> <span class="pre">a</span> <span class="pre">new</span> <span class="pre">class</span> <span class="pre">``ERobot</span></code> is more general and allows for branching (but not closed
kinematic loops).
The robot is described by a set of <code class="docutils literal notranslate"><span class="pre">ELink</span></code> objects, each of which points to its parent link.
The <code class="docutils literal notranslate"><span class="pre">ERobot</span></code> has references to the root and leaf <a href="#id16"><span class="problematic" id="id17">``</span></a>ELink``s.
This structure closely mirrors the URDF representation, allowing for easy import of URDF models.</p>
</div>
<div class="section" id="collision-checking">
<h3>Collision checking<a class="headerlink" href="#collision-checking" title="Permalink to this headline">Â¶</a></h3>
<p>RTB-M had a simple, contributed but unsupported, collision checking capability.
This is dramatically improved in the Python version using using <a class="reference external" href="https://pybullet.org/wordpress/">PyBullet</a> which supports primitive shapes such as Cylinders, Spheres and Boxes as well as mesh objects.
Every robot link has a collision shape in addition to the shape used for rendering.
We can conveniently perform collision checks between links as well as between whole robots, discrete links, and objects in the world. For example a <span class="math notranslate nohighlight">\(1 \times 1 \times 1\)</span> box
centered at <span class="math notranslate nohighlight">\((1,0,0)\)</span> can be tested against all, or just one link, of the robot by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">panda</span> <span class="o">=</span> <span class="n">rtb</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Panda</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obstacle</span> <span class="o">=</span> <span class="n">rtb</span><span class="o">.</span><span class="n">Box</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">SE3</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iscollision</span> <span class="o">=</span> <span class="n">panda</span><span class="o">.</span><span class="n">collided</span><span class="p">(</span><span class="n">obstacle</span><span class="p">)</span> <span class="c1"># boolean</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iscollision</span> <span class="o">=</span> <span class="n">panda</span><span class="o">.</span><span class="n">links</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">collided</span><span class="p">(</span><span class="n">obstacle</span><span class="p">)</span>
</pre></div>
</div>
<p>Additionally, we can compute the minimum Euclidean distance between whole robots, discrete links, or objects and get the points in the world frame which construct this line.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">panda</span><span class="o">.</span><span class="n">closest_point</span><span class="p">(</span><span class="n">obstacle</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">panda</span><span class="o">.</span><span class="n">links</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">closest_point</span><span class="p">(</span><span class="n">obstacle</span><span class="p">)</span>
</pre></div>
</div>
<p>which returns the distance and the coordinates of the closest points on the two bodies.</p>
<p>% Bullet is a fast and mature package which we found gave better results than FCLcite{}
% but found that closest points between polyhedra snapped to vertices rather than the actual closest points on
% faces.</p>
</div>
<div class="section" id="interfaces">
<h3>Interfaces<a class="headerlink" href="#interfaces" title="Permalink to this headline">Â¶</a></h3>
<p>RTB-M could only animate a robot in a figure, and there was limited but not-well-supported ability to interface to V-REP
and a physical robot.
The Python version supports a simple, but universal API to a robot
inspired by the simplicity and expressiveness of the OpenAI Gym API which was designed as a toolkit for developing and comparing reinforcement learning algorithms.
Whether simulating a robot or controlling a real physical robot, the API operates in the same manner, providing users with a common interface which is not found amoung other robotics packages.</p>
<p>By default the Toolbox behaves like the MATLAB version with a plot method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">puma</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
</pre></div>
</div>
<p>which will plot the robot at the specified joint configurmation, or animate it if <a href="#id18"><span class="problematic" id="id19">``</span></a>q``is an <span class="math notranslate nohighlight">\(m \times 6\)</span> matrix, using
the default <a href="#id20"><span class="problematic" id="id21">``</span></a>PyPlot``backend which draws a <a href="#id22"><span class="problematic" id="id23">``</span></a>noodle robotâ€™â€™ using matplotlib similar to that
shown in Figure ref{fig:noodle}.</p>
<p>The more general solution, and what is implemented inside <code class="docutils literal notranslate"><span class="pre">plot</span></code> in the example above, is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pyplot</span> <span class="o">=</span> <span class="n">roboticstoolbox</span><span class="o">.</span><span class="n">backends</span><span class="o">.</span><span class="n">PyPlot</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pyplot</span><span class="o">.</span><span class="n">launch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pyplot</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">puma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">puma</span><span class="o">.</span><span class="n">q</span> <span class="o">=</span> <span class="n">q</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">puma</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
</pre></div>
</div>
<p>This makes it possible to animate multiple robots in the one graphical window, or the one robot in various environments either graphical
or real.</p>
<p>The VPython backend, see Fig. ref{fig:vpython}, provides browser-based 3D graphics based on WebGL.  This is advantageous for displaying on mobile
devices.  Swift, see Fig. ref{fig:ur-lineup}, is a web-based visualizer using three.js to provide high-quality 3D animations.
It can produce vivid 3D effects using anaglyphs viewed with colored glasses.
Animations can be recorded as MP4 files or animated GIF files which are useful for inclusion in GitHub markdown documents.</p>
</div>
<div class="section" id="code-engineering">
<h3>Code engineering<a class="headerlink" href="#code-engineering" title="Permalink to this headline">Â¶</a></h3>
<p>The code is implemented in Python <span class="math notranslate nohighlight">\(\ge 3.6\)</span> and all code is hosted on GitHub and
unit-testing is performed using GitHub-actions. Test coverage is uploaded to
<code class="docutils literal notranslate"><span class="pre">codecov.io</span></code> for visualization and trending, and we use <code class="docutils literal notranslate"><span class="pre">lgtm.com</span></code> to perform
automated code review. The code is documented with ReStructured Text format
docstrings which provides powerful markup including cross-referencing,
equations, class inheritance diagrams and figures â€“ all of which is converted
to HTML documentation whenever a change is pushed, and this is accessible via
GitHub pages. Issues can be reported via GitHub issues or patches submitted as
pull requests.</p>
<p>RTB-P, and its dependencies, can be installed simply by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pip install roboticstoolbox-python
</pre></div>
</div>
<p>which includes basic visualization using matplotlib.
Options such as <code class="docutils literal notranslate"><span class="pre">vpython</span></code> can be used to specify additional dependencies to be installed.
The Toolbox adopts a â€œwhen neededâ€ approach to many dependencies and will only attempt
to import them if the user attempts to exploit a particular functionality.  If the dependency is not installed a warning provides instructions on how to install them using pip.
More details are given on the project home page.
This applies to the visualizers Vpython and Swift, as well as pybullet and ROS.
The Toolbox provides capability to import URDF-xacro files without ROS.
The backend architecture allows a user to connect to a ROS environment if required, and only then does ROS have to be
installed.</p>
</div>
</div>
<div class="section" id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">Â¶</a></h2>
<p>This article has introduced and demonstrated in tutorial form the principle features of the Robotics
Toolbox for Python which runs on Mac, Windows and Linux.% using Python 3.6 or better.
The code is free and open, and released under the MIT licence.
It provides many of the essential tools necessary for
robotic manipulator modelling, simulation and  control which is essential for robotics education  and research.
It is familiar yet new, and we hope it will serve the community well for the next 25 years.</p>
<p>Currently under development are backend interfaces for CoppeliaSim, Dynamixel servo chains, and ROS;
symbolic dynamics, simplification and code generation; mobile robotics motion models, planners, EKF localization, map making and SLAM; and a minimalist block-diagram simulation toolfootnote{url{<a class="reference external" href="https://github.com/petercorke/bdsim">https://github.com/petercorke/bdsim</a>}}.</p>
<dl class="citation">
<dt class="label" id="corke95d"><span class="brackets"><a class="fn-backref" href="#id2">Corke95d</a></span></dt>
<dd><ol class="upperalpha simple" start="16">
<li><p>Corke. A computer tool for simulation and analysis: the Robotics Toolbox for MATLAB. In Proc. National Conf. Australian Robot Association, pages 319â€“330, Melbourne, July 1995.</p></li>
</ol>
</dd>
<dt class="label" id="corke96j"><span class="brackets"><a class="fn-backref" href="#id3">Corke96j</a></span></dt>
<dd><ol class="upperalpha simple" start="16">
<li><p>Corke. A robotics toolbox for MATLAB. IEEE Robotics and Automation Magazine, 3(1):24â€“32, Sept. 1996.</p></li>
</ol>
</dd>
<dt class="label" id="craig2005"><span class="brackets"><a class="fn-backref" href="#id4">Craig2005</a></span></dt>
<dd><p>Introduction to Robotics, John Craig, Wiley, 2005.</p>
</dd>
<dt class="label" id="featherstone87"><span class="brackets"><a class="fn-backref" href="#id5">Featherstone87</a></span></dt>
<dd><ol class="upperalpha simple" start="18">
<li><p>Featherstone, Robot Dynamics Algorithms. Kluwer Academic, 1987.</p></li>
</ol>
</dd>
<dt class="label" id="ets1"><span class="brackets">ets1</span><span class="fn-backref">(<a href="#id6">1</a>,<a href="#id10">2</a>,<a href="#id13">3</a>)</span></dt>
<dd><ol class="upperalpha simple" start="16">
<li><p>Corke, â€œA simple and systematic approach to assigning Denavit- Hartenberg parameters,â€ IEEE transactions on robotics, vol. 23, no. 3, pp. 590â€“594, 2007.</p></li>
</ol>
</dd>
<dt class="label" id="ets2"><span class="brackets"><a class="fn-backref" href="#id7">ets2</a></span></dt>
<dd><ol class="upperalpha simple" start="10">
<li><p>Haviland and P. Corke, â€œA systematic approach to computing the manipulator Jacobian and Hessian using the elementary transform sequence,â€ arXiv preprint, 2020.</p></li>
</ol>
</dd>
</dl>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="arm.html" class="btn btn-neutral float-right" title="Manipulator arms" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Robotics Toolbox for Python" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Jesse Haviland and Peter Corke
      <span class="lastupdated">
        Last updated on 13-Nov-2020.
      </span>

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'G-11Q6WJM565', 'auto');
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>